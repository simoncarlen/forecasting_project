
\section{Background}

Outdoor air pollution is a major global environmental issue, linked to several serious health conditions, and causing millions of premature deaths every year \cite{who2016}. Some principal air pollutants damaging to health include gaseous substances such as nitrogen oxides (NO$_x$), ground-level ozone (O$_3$), sulphur dioxide (SO$_2$), and carbon monoxide (CO), but also atmospheric aerosol particles such as PM$_{10}$ and PM$_{2.5}$ \cite{VanLoon2010}. In Stockholm, traffic is a major source of local air pollution, and though air quality is generally good, some streets experience short episodes with severe pollution levels, especially during winter and spring \cite{slbanalys}. %The air in the Stockholm region is regularly monitored by the environmental and health administration (EHA) of the city of Stockholm \cite{slb-matningar}. 

To protect public health, urban air is normally monitored. In addition to monitoring, forecasts of air quality (both hourly and daily) can be critical to regulatory authorities, and in general, there are two approaches to this; with mechanistic models or statistical and/or machine learning models. \cite{ElHarbawi2013, Liao2020, atmos7020015}. %The deterministic dispersion models are common and used e.g. by the EHA of Stockholm \cite{slbanalys}. Some commonly used statistical models include multiple linear regression (MLR), autoregressive integrated moving average (ARIMA), and variants thereof \cite{atmos7020015}. 
With mechanistic models, the processes governing the evolution of air pollution is modeled mathematically, whereas statistical and machine learning models are more data-driven \cite{atmos7020015}. 

From a statistical perspective, predicting air pollution is a time series regression problem, and there are many different regression techniques for forecasting and time series analysis \cite{atmos7020015}. These techniques can vary in complexity, from more simple linear models to deep neural networks capable of finding complex non-linear relationships in the data \cite{atmos7020015, LeCun2015}. Nonetheless, one of the main challenges with air pollution is that there are dependencies over both space and time (i.e., the data is spatio-temporal), and simpler models may not capture these dependencies \cite{Liao2020}. \textcolor{red}{Recent advances in machine learning however have shown promising results when it comes to air quality forecasts, especially deep neural networks \cite{Liao2020, atmos7020015}.} 

%Some variants of combined deep neural networks with one spatial and one temporal component have been implemented however, and these "hybrid networks" have shown promising results \cite{Liao2020, Gilik2021}. 

%However, many common statistical and machine learning techniques have some limitations when applied to air pollution data. For example, they may not be ideally suited when there are dependencies over time, i.e, when the data is sequential (or so-called time-series data), and they may not capture spatial dependencies between different monitoring stations  \cite{Liao2020}. However, with the recent advances in deep learning \cite{LeCun2015}, many of the issues with large, high-dimensional "spatio-temporal" datasets have been  addressed \cite{Liao2020}. Deep learning is capable of detecting intricate input-output relationships in massive datasets, and there are variants of deep neural networks "tailored" to handling both sequential data as well as data where spatial dependencies are important \cite{LeCun2015}. For air pollution forecasts, variants of combined deep neural networks with one spatial and one temporal component have been implemented and these hybrid networks have shown promising results \cite{Liao2020, Gilik2021}. 

%More recently, machine learning methods have become increasingly popular, and some common algorithms for predicting air pollution are random forests, gradient boosting machines, and support vectors machines \cite{FaganeliPucer2018, Arsov2021}. Though successfully implemented, many of the statistical and machine learning models have some limitations when applied to air pollution data. They are not ideally suited when there are dependencies over time, i.e, when the data is sequential (or so-called time-series data), and they may not capture spatial dependencies between different monitoring stations  \cite{Liao2020}. Moreover, the relationship between predictor variables and the response variable(s) in air pollution data may also be very complex and non-linear, and often the data is high-dimensional \cite{Liao2020}. 

%With the recent advances in deep learning \cite{LeCun2015}, many of the issues with large, high-dimensional "spatio-temporal" datasets have been  addressed \cite{Hamdi2021}. Deep learning is capable of detecting intricate input-output relationships in massive datasets, and there are variants of deep neural networks "tailored" to handling both sequential data as well as data where spatial dependencies are important \cite{LeCun2015}. For air pollution forecasts, variants of combined deep neural networks with one spatial and one temporal component have been implemented and these hybrid networks have shown promising results \cite{Liao2020, Gilik2021, Qin2019}. 

%In this work, historical data from several air monitoring stations in the Stockholm region will be used together with weather data to make prediction models of various complexity. The performance of the models will be evaluated and compared to similar work in the literature, but also to the models used by the EHA of Stockholm (mechanistic models). Lastly, the models will be tested on data from other cities, and a transfer learning approach will be used.

\section{Research problem}

Forecasts, be it for weather, stock returns, or future pandemics, are always associated with uncertainty and errors. Erroneous predictions made by existing air pollution forecasting systems, both mechanistic and statistical and/or machine learning-based, can be attributed to many causes. 
In the case of mechanistic models, there can be insufficient information about the necessary parameters needed for simulation and modeling \cite{atmos7020015}. For statistical and/or machine learning methods, too simplistic models, lack of data, irrelevant input features, overfitting, etc., can limit prediction accuracy \cite{atmos7020015}. 

Nevertheless, atmospheric pollution is a very complex phenomenon depending on a multitude of factors across both space and time. Hence, the research problem addressed in this work is:

\begin{itemize}
\item To capture and model the complex dynamics of air pollution with modern machine learning methods, in particular deep learning.
\end{itemize}

%\textit{using state-of-the-art machine learning methods, in particular deep learning, to more successfully capture and model the complex dynamics of air pollution.}

%the research problem this work attempts to address is if state of the art machine learning solutions successfully can model these complex dynamics of air pollution. 

%and existing forecasting models/systems for air pollution make erroneous predictions which tend to be largest when pollution levels peak. In the case of mechanistic models, this is due to insufficient information about necessary parameters  and 

\section{Research question}

%The main research question for this thesis tries to answer is:

%In this work, a number of machine learning models are tested, evaluated, and compared in order to answer the main research question: 
%The main research question for this thesis is:
%\textit{Can machine learning models accurately forecast air pollution levels in Stockholm?}

%\begin{center} \textit{Can machine learning models accurately forecast air pollution levels in Stockholm?} \end{center}

From a forecasting perspective, of special interest are episodes when pollution levels peak. Generally, this is also when existing forecasting models tend to give the largest prediction errors \cite{atmos7020015}. Therefore, the research question this thesis tries to answer is: 

\begin{itemize}
\item How can machine learning, in particular deep learning, be used to forecast air pollution levels and pollution peaks?
\end{itemize}

%an additional sub-question related to the main research question is: \textit{Can machine learning models reliably predict peaks in pollution levels?}


%\begin{center} \textit{Can machine learning models reliably predict peaks in pollution levels?}  \end{center}

%How do machine learning, in particular deep learning, perform in comparison with the dispersion models used by the EHA of Stockholm? Can machine learning algorithms trained on Stockholm data be successfully transferred to other cities with similar conditions? Can density predictions instead of point-predictions be constructed so that if thresholds are of interest, the probability of air pollution levels exceeding a certain level can be calculated?  

\section{Delimitations}

In this work, historical air pollution and weather data is used. Therefore, the models cannot be tested in "operational mode", i.e., with real-time data to make predictions. Moreover, when forecasting air pollution (hours or days ahead), weather forecasts are often utilized in addition to monitoring data to improve forecast results. Again, with historical data, incorporating weather forecasts is not possible, and consequently the models make predictions based only on multivariate time-series of past observations. This also puts a limit on the time-horizon for the predictions, since without weather forecasts, medium to long-term forecasts of air quality would have large uncertainties.  

\textcolor{red}{pollution background levels...}
